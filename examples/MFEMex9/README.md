The proposed  framework is applied to construct a non-intrusive reduced-order model of the [**MFEM Example 9 Time-Dependent Radial Advection**](https://github.com/mfem/mfem/blob/master/examples/ex9.cpp).


The [ex9.cpp](https://github.com/mfem/mfem/blob/master/examples/ex9.cpp) is modified to include the parameterized initial condition and an option to compute the residual given the predicted solutions from the model. The modified `ex9.cpp` and the corresponding executable (`ex9`) are located at `glasdi/src/`. The executable (`ex9`) can be used to generate data and will be called to compute residual-based error indicator during training of the model.
 
 
**Procedure**:
- run `generate_data.ipynb` to generate dataset; A mesh file ([`periodic-square.mesh`](https://github.com/mfem/mfem/blob/master/data/periodic-square.mesh)) is included in `glasdi/examples/MFEMex9/`.
    1. generate initial training parameter cases on a given parameter space
    2. generate a dataset of discrete parameter space for adaptive greedy sampling and evaluation
- run `train_model.ipynb` to train a model by submitting a job using `batch_job.bsub`
    - If the training time exceeds the maximum allowable wall time, the training can be continued by
    updating the following parameters in `train_model.ipynb` and submitting additoinal jobs:
        - `params['retrain'] = True`
        - `save_name` (file name of the trained model)
- run `test_model.ipynb` to evalute the trained model


The data can be generated by running `generate_data.ipynb`. For example, to generate n x n discrete parameter cases with w1 in [1.5,2.0] and w2 in [2.0,2.5], one can set
- `p1_arr = np.linspace(1.5,2.0,n)`
- `p2_arr = np.linspace(2.0,2.5,n)`

To reproduce the numerical results in the paper, one can generate the following datasets for training and testing:
  - An initial training set: 2 x 2 parameter cases on the given parameter space, which are initial parameter cases located at the corners of the parameter space
  - A training set for adaptive sampling: 11 x 11 parameter cases on the given parameter space; a dataset of discrete parameter space for adaptive greedy sampling
  - A testing set: 21 x 21 parameter cases on the given parameter space; a dataset of discrete parameter space for evaluation

Note that to enhance the training efficiency, the dataset of a discrete parameter space (e.g., 11 x 11 parameter cases) for adaptive greedy sampling is generated before training starts, which means the solution of the optimal parameter case (with the maximum error indicator) is retrieved from the dataset without calling the solver of the full-order model during training. The proposed framework can be adapted to a continuous parameter space and the solution of sampled parameter cases can be generated by running full-order model simulations during training.
